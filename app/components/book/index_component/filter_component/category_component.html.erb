<%= form_with(url: url, method: 'get', local: true, html: { data: { controller: [identifier, 'dropdown'].join(' '), turbo_action: 'advance', turbo_frame: 'outer-frame' } }) do |form| %>
  <label id="listbox-label" class="block text-sm font-medium text-gray-700"> Categories </label>
  <div class="mt-2 relative">
    <button type="button" class="bg-white relative w-full border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" aria-haspopup="listbox" aria-expanded="true" aria-labelledby="listbox-label" data-action="dropdown#toggle click@window->dropdown#hide">
      <span class="block truncate"> <%= selected_category %> </span>
      <span class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
        <%= solid_icon('selector', class: 'w-5 h-5 text-gray-400', 'aria-hidden': 'true') %>
      </span>
    </button>
        <div
      data-Dropdown-target="menu"
      class="absolute z-50 mt-1 hidden max-h-60 w-full overflow-auto rounded-md bg-white py-1 shadow-lg ring-black ring-opacity-5"
    >
      <div role="none">
        <% menu_items.each do |option| %>
          <div
            class="relative cursor-pointer select-none text-gray-800 transition-colors duration-100 ease-in-out hover:bg-blue-600 hover:text-white"
            role="menuitem"
          >
            <%=
              radio_button_tag :category,
                               option,
                               active_category?(option),
                               class: 'absolute w-full h-full opacity-0 inset-0 z-50',
                               data: {
                                 action:
                                   if active_category?(option)
                                     "click->#{identifier}#clear"
                                   else
                                     "click->#{identifier}#submit"
                                   end,
                               }
            %>
            <div class="relative py-2 pl-3 pr-9 sm:text-sm">
              <% if active_category?(option) %>
                <span
                  class="text-indigo-600 pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2 "
                >
                  <%= solid_icon 'check', class: 'w-5 h-5 text-blue-600', 'aria-hidden': true %>
                </span>
              <% end %>
              <%= tag.span class: ['block truncate', { 'font-semibold': active_category?(option), 'font-normal': !active_category?(option) }] do %>
                <%= option %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>